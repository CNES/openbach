<section>
  <!-- Page Content -->
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <h1 class="page-header">Installation
        </h1>
      </div>
    </div>
  </div>
  <div class="page-wrap">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <p>The current page explains how to install an OpenBACH platform. For more details and advanced procedures (user manual debug information, etc.), please read the <a href="https://wiki.net4sat.org/doku.php?id=openbach:manuals:2.x:index">installation manual</a> in the OpenBACH wiki.</p>
          <h2 class="install" id="requirements">Requirements</h2>
          <p>In order to build an OpenBACH platform, you need at least the following components:
          <ul>
            <li>A Controller </li>
            <li>A Collector</li>
            <li>An Auditorium</li>
            <li>1 or more Agents</li>
          </ul>
          <p>The Controller, the collector and the auditorium might be installed in the same host (i.e. a machine/entity) or in separate hosts.</p>
          <h2 class="install" id="install">Install</h2>
          <p>The target machines shall:
            <ul>
              <li>be installed on Ubuntu 20.04 LTS (this restriction may be removed in the future for the agent component). </li>
              <li>allow SSH connections. </li>
              <li>have a 64 bits OS (only for the Collector). </li>
              <li>have at least 2Gb of RAM (if Controller/Collector/Auditorium are in the same machine) and 512Mb for Agents.</li>
            </ul>
          </p>
          <p>The install of OpenBACH is performed via <a href="http://www.ansible.com">Ansible</a>. Be aware that you need to learn some Ansible concepts to ease the following procedure.</p>
          <p>The step-by-step installation is described below (this is just an example with basic configuration details, please go to <a href="https://wiki.net4sat.org/doku.php?id=openbach:manuals:2.x:index">installation manual</a> for advanced informations):
            <ol class="wizard_steps">
              <li>First you need to download the sources (it is recommended to get the master branch):</li>
              <ul style="padding-left: 4em;">
                <div class="shell-div">
                  <br>
                  <code class="shell">
                  $ git clone --depth 1 https://forge.net4sat.org/openbach/openbach.git </code>
                </div>
              </ul>
              <li>For SSH communication, (if it is not already done) you must add the Controller, the Collector, the Auditorium and the Agents to the ssh "known_hosts" file of the host from which you install OpenBACH:</li>
              <ul style="padding-left: 4em;">
                <div class="shell-div">
                  <br>
                  <code class="shell">
                  $ ssh-keyscan -H *ip_address* >> ~/.ssh/known_hosts</code>
                </div>
              </ul>
              <li>The machine from which you install OpenBACH requires Ansible (between version 2.10 and 2.10.5, as well as Python 3.8.5 or newer). Please refer to <a href="http://docs.ansible.com/ansible/intro_installation.html#latest-releases-via-apt-ubuntu">Ansible website</a> to install Ansible.</li>
              <li> You might need to install sshpass/openssh.</li>
              <li> Before deploying OpenBACH to your target machines, you need to configure which component will be installed on which machine. Since the installation of OpenBACH is done through Ansible playbooks, this configuration uses their inventory files capabilities. Just create a file in the ansible/inventory folder of your sources and populate it with your installation instructions. We propose herein an example where Controller/Collector/Auditorium are installed in the same machine (indeed if Collector/Auditorium are not specified, they are installed with the Controller), and two Agents in separate machine (for advanced topologies go to <a href="https://wiki.net4sat.org/doku.php?id=openbach:manuals:2.x:index">installation manual</a>):</li>
              <ul style="padding-left: 4em;">
                <div class="shell-div">
                  <br>
                  <pre class="shell">
[controller] 
172.20.0.1 

[agent]
172.20.0.2
172.20.0.3 

[all:vars]
ansible_python_interpreter=/usr/bin/python3
</pre>
                </div>
              </ul>
              <li> Before the install, we highly recommend to test the connectivity (between machines) and the ssh/ansible configuration by means of an ansible ping. <i>ssh_username</i> is a username with sudo rights on the target machines, <i>inventory/file</i> is the path to the file you have created in the step above (use the option --private-key=*path_to_private_key* if you connect to the machines via a private_key):</li>
              <ul style="padding-left: 4em;">
                <div class="shell-div">
                    <br>
                    <code class="shell">
                    $ ansible -i *inventory/file* -u *ssh_username* -k -K -m ping all</code>
                </div>
              </ul>
              <li>You can install OpenBACH with the following command. For detailed options, go to <a href="https://wiki.net4sat.org/doku.php?id=openbach:manuals:2.x:index">installation manual</a> (Use the option --private-key=*path_to_private_key* if you connect to the machines via a private_key):</li>
              <ul style="padding-left: 4em;">
                <div class="shell-div">
                  <br>
                  <code class="shell">
                  $ ansible-playbook install.yml -u *ssh_username* -k -K</code>
                </div>
              </ul>
              <li>Finally, You can go to http://your_controller_ip/ for OpenBACH</li>
            </ol>
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
