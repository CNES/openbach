!function(e){var t=function(e){this.initialized=!0,this.images=[],this.awakeImages=[],this.asleepImages=[],this.viewportHeight=window.innerHeight||document.documentElement.clientHeight},i=function(){if(!window.FlickrEmbedr||!window.FlickrEmbedr.initialized){var e=window.FlickrEmbedr?window.FlickrEmbedr.q:[];window.FlickrEmbedr=new t,window.FlickrEmbedr._parseGlobalDisplayOptions(),window.addEventListener("message",function(e){window.FlickrEmbedr.handlePostMessage(e)},!1),e&&e.length>0&&(e.indexOf("all")>-1?window.FlickrEmbedr.process("all"):e.indexOf("inline")>-1&&window.FlickrEmbedr.process("inline")),window.FlickrEmbedr._scanForChanges(),window.addEventListener("scroll",n(function(){window.FlickrEmbedr._handleScroll()},250)),window.addEventListener("resize",n(function(){window.FlickrEmbedr.viewportHeight=window.innerHeight||document.documentElement.clientHeight},250))}},r=function(e){try{e=parseInt((e+"").replace("px",""),10)}catch(t){}return e},a=function(e,t,i){var a=t;return(!t||r(a)<1)&&(a=r(e.width),r(a)<1&&(a=r(e.style.width),r(a)<1&&(a=r(getComputedStyle(e,null).getPropertyValue(i))))),a},n=function(e,t,i){var r;return function(){var a=this,n=arguments,o=function(){r=null,i||e.apply(a,n)},s=i&&!r;clearTimeout(r),r=setTimeout(o,t),s&&e.apply(a,n)}},o=function(e){var t=e.node.getBoundingClientRect(),i=2*window.FlickrEmbedr.viewportHeight;return t.top>=0-i&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)+i};getDevicePixelRatio=function(){var e=1;return void 0!==window.screen.systemXDPI&&void 0!==window.screen.logicalXDPI&&window.screen.systemXDPI>window.screen.logicalXDPI?e=window.screen.systemXDPI/window.screen.logicalXDPI:void 0!==window.devicePixelRatio&&(e=window.devicePixelRatio),e},getSizeToFit=function(e,t,i){function r(e){return e.source.indexOf(".jpg")>-1}var a,i={},n=parseInt(t.width,10),o=parseInt(t.height,10),s=getDevicePixelRatio(),l=n*s,d=o*s,c=e,h=i.excludeSizes||["o"],g=!1,p=!1,m={};return c.filter(r).forEach(function(e){var t,i=e.key||e.url.match(/\/sizes\/([a-z0-9]+)\/$/)[1];e&&-1===h.indexOf(i)&&((e.width>=l||e.height>=d)&&(t=!0),t&&(g?e.height<g.height&&e.width<g.width&&(g=e):g=e),p?(e.width>p.width||e.height>p.height)&&(p=e):p=e),a=g||p}),m.width=n,m.height=a.height*(n/a.width),{displayUrl:a.source,fittedWidth:Math.round(m.width),fittedHeight:Math.round(m.height)}},getPhotoForDisplay=function(e){var t,i,r=e.contentDocument.querySelector(".flickr-embed-photo").getBoundingClientRect(),a=getPixelRatio(),n=this.get("photo").getSizeToFit(r,options);return t=Math.min(r.height/a,n.height),i=Math.min(r.width/a,n.width/n.height*t),t=Math.min(t,n.height/n.width*i),{width:Math.round(i),height:Math.round(t),url:n.url,pixelRatio:n.width/i}},displayOptions=["header","footer","comment-count","fave-count","branding","truncate","letterbox","context","lang","sharing","vr","gp"],supportedTypes=['a[href*="flickr.com"][data-flickr-embed="true"] img','img[src^="https://farm"][src*="flickr.com"][src$=".jpg"]','img[src^="https://farm"][src*="flickr.com"][src$=".jpg?zz=1"]','img[src^="http://farm"][src*="flickr.com"][src$=".jpg"]','img[src^="http://farm"][src*="flickr.com"][src$=".jpg?zz=1"]','img[src^="//farm"][src*="flickr.com"][src$=".jpg"]','img[src^="//farm"][src*="flickr.com"][src$=".jpg?zz=1"]','img[src^="https://c"][src*="flickr.com"][src$=".jpg"]','img[src^="https://c"][src*="flickr.com"][src$=".jpg?zz=1"]','img[src^="http://c"][src*="flickr.com"][src$=".jpg"]','img[src^="http://c"][src*="flickr.com"][src$=".jpg?zz=1"]','img[src^="//c"][src*="flickr.com"][src$=".jpg"]','img[src^="//c"][src*="flickr.com"][src$=".jpg?zz=1"]'],t.prototype.process=function(e){this.detectImages(e),this.processImages()},t.prototype.handlePostMessage=function(e){e.data&&e.data.name&&("update:height"===e.data.name?e.source.frameElement.style.height=e.data.height:"update:resize"===e.data.name&&this.handleImageResize(e.source,e.data))},t.prototype.handleImageResize=function(e,t){var i=getSizeToFit.call(this,t.size.sizes,t.size),r=e.document.querySelector('a[data-is-current-slide="true"] img'),a=e.document.querySelector("video"),n=e.document.querySelector(".flickr-embed-photo");a||(r||(r=e.document.querySelector("a.slide img")),r.style.width=parseInt(i.fittedWidth,10)+"px",r.style.height=parseInt(i.fittedHeight,10)+"px",n.style.width=i.fittedWidth+"px",n.style.height=i.fittedHeight+"px",e.frameElement.style.height=e.document.body.clientHeight,r.src!==i.displayUrl&&(r.src=i.displayUrl))},t.prototype.detectImages=function(e){var t;"inline"===e?t=Array.prototype.slice.call(document.querySelectorAll('[data-flickr-embed="true"] img')):"all"===e&&(t=Array.prototype.slice.call(document.querySelectorAll(supportedTypes)));for(var i=0,r=t.length;r>i;i++)-1===this.images.indexOf(t[i])&&(this.images.push(t[i]),t[i]={node:t[i],processed:!1},o(t[i])?this.awakeImages.push(t[i]):this.asleepImages.push(t[i]))},t.prototype.processImages=function(){function e(e){this.awakeImages[e]&&!this.awakeImages[e].processed&&(this.parseImage(this.awakeImages[e].node),this.awakeImages[e].processed=!0)}for(var t=0;t<this.awakeImages.length;t++)this.awakeImages[t].node&&this.awakeImages[t].node.naturalWidth>0&&this.awakeImages[t].node.naturalHeight>0?this.awakeImages[t]&&!this.awakeImages[t].processed&&(this.parseImage(this.awakeImages[t].node),this.awakeImages[t].processed=!0):this.awakeImages[t].node.addEventListener("load",e.bind(this,t),!1)},t.prototype.parseImage=function(e){if(e&&e.tagName&&"img"===e.tagName.toLowerCase()){var t,i,r,n,o,s,l,d,c=/(flickr.com|flic.kr)\/(photos|p)\/([0-9a-zA-Z-_]+|[0-9]+@N[0-9]+)\/([0-9]+)\/?(in)?\/?([^\/]+)?/,h=/(flickr.com|flic.kr)\/gp\/([0-9a-zA-Z-_]+|[0-9]+@N[0-9]+)\/([a-zA-Z0-9]+)\/?/,g=/(flickr.com|flic.kr)\/(photos|p)\/([0-9a-zA-Z-_]+|[0-9]+@N[0-9]+)\/(sets|albums)\/([0-9]+)\/?(in)?\/?([^\/]+)?/,p=/(flickr.com|flic.kr)\/(photos|p)\/([0-9a-zA-Z-_]+|[0-9]+@N[0-9]+)\/galleries\/([0-9]+)\/?/,m=/(\d+)_([a-zA-Z0-9]+)_?[a-z0-9]{0,2}\.jpg(\?zz=1)*$/,u=null;s=e.width,l=s/e.naturalWidth,o=parseInt(e.naturalHeight*l,10),e.width<=150||("a"===e.parentNode.nodeName.toLowerCase()&&""!==e.parentNode.href&&"#"!==e.parentNode.href?(i=e.parentNode.href.match(c),r=e.parentNode.href.match(g),galleryInfo=e.parentNode.href.match(p),gpInfo=e.parentNode.href.match(h),n=e.parentNode,o=a(e.parentNode,o,"height"),s=a(e.parentNode,s,"width"),d=e.src.match(m)[2],i?(t="/photos/"+i[3]+"/"+i[4],-1!==i.indexOf("in")&&(t=t+"/in/"+i[i.indexOf("in")+1],this.isSlideshow=!0)):gpInfo?(u=gpInfo[3],t="/photos/"+gpInfo[2]+"/"+e.src.match(m)[1]):r?t="/photosets/"+r[5]:galleryInfo&&(t="/galleries/"+galleryInfo[3]+"-"+galleryInfo[4])):(i=e.src.match(m),i&&(t="/photos/"+i[1],n=e,o=a(e,o,"height"),s=a(e,s,"width"),d=i[2])),e&&t&&this.replaceImg(e,t,n,{width:s,height:o},d,u))}},t.prototype.replaceImg=function(t,i,r,a,n,o){var s,l,d,c=t.className?" "+t.className:"",h=new XMLHttpRequest,g=window.getComputedStyle(t,null);"A"===r.tagName?d=r.getElementsByTagName("img")[0]:"IMG"===r.tagName&&(d=r),s=document.createElement("iframe"),s.setAttribute("frameborder","0"),s.setAttribute("allowfullscreen",""),s.className="flickr-embed-frame"+c,s.setAttribute("webkitallowfullscreen",""),s.setAttribute("mozallowfullscreen",""),s.setAttribute("oallowfullscreen",""),s.setAttribute("msallowfullscreen",""),t.getAttribute("align")&&s.setAttribute("align",t.getAttribute("align")),s.style.cssText=t.style.cssText,s.style.overflow="hidden",s.style.paddingTop=g.getPropertyValue("padding-top"),s.style.paddingRight=g.getPropertyValue("padding-right"),s.style.paddingBottom=g.getPropertyValue("padding-bottom"),s.style.paddingLeft=g.getPropertyValue("padding-left"),s.style.marginTop=g.getPropertyValue("margin-top"),s.style.marginRight=g.getPropertyValue("margin-right"),s.style.marginBottom=g.getPropertyValue("margin-bottom"),s.style.marginLeft=g.getPropertyValue("margin-left"),s.width=a.width,s.height=a.height,s.setAttribute("data-natural-width",t.naturalWidth),s.setAttribute("data-natural-height",t.naturalHeight),s.style.width=s.width+"px",s.style.height=s.height+"px",s.style.maxWidth=g.getPropertyValue("max-width"),s.style.display="none",l=this._parseDisplayOptions(r),h.onreadystatechange=function(){var e,t,i=function(){s.setAttribute("data-loaded","true"),s.style.display="",s.style.height=s.contentDocument.querySelector("body").clientHeight+"px",null!==r.parentNode&&r.parentNode.removeChild(r),t?t.removeEventListener("loadstart",i):e.removeEventListener("load",i),s.contentWindow.document.close()};if(4===h.readyState){if(!r.parentNode||null===r.parentNode)return;if(r.parentNode.insertBefore(s,r),s.contentWindow.document.write(h.response),e=s.contentDocument.querySelector("img"),t=s.contentDocument.querySelector("video"),!e&&!t)return void s.parentNode.removeChild(s);t?t.addEventListener("loadstart",i):e.addEventListener("load",i)}};var p=["width="+s.width,"height="+s.height,"secret="+n];o&&p.push("gp="+o),h.open("GET",e+i+"?"+p.join("&")+l,!0),h.setRequestHeader("X-Embedr-Referrer",window.location.href),h.send(null)},t.prototype._handleScroll=function(){for(var e=[],t=0,i=this.asleepImages.length;i>t;t++)o(this.asleepImages[t])?this.awakeImages.push(this.asleepImages[t]):e.push(this.asleepImages[t]);this.asleepImages=e,this.processImages()},t.prototype._scanForChanges=function(){var e,t={childList:!0,subtree:!0};"undefined"==typeof MutationObserver?this.scanForChanges=window.setInterval(function(){window.FlickrEmbedr.process("inline")},1e3):(e=new MutationObserver(function(e){for(var t=0,i=e.length;i>t;t++)if(e[t].addedNodes.length&&e[t].addedNodes[0].querySelector&&null!==e[t].addedNodes[0].querySelector('[data-flickr-embed="true"] img'))return void window.FlickrEmbedr.process("inline")}),e.observe(document.body,t))},t.prototype._parseGlobalDisplayOptions=function(){if(!this.globalDisplayOptions){this.globalDisplayOptions={};for(var e="flickr:embedr:",t=document.querySelectorAll('meta[name^="'+e+'"]'),i=0,r=t.length;r>i;i++)this.globalDisplayOptions[t[i].getAttribute("name").replace(e,"")]=t[i].getAttribute("content")}},t.prototype._parseDisplayOptions=function(e){for(var t,i=[],r=JSON.parse(JSON.stringify(this.globalDisplayOptions)),a=0;a<displayOptions.length;a++)t=e.getAttribute("data-"+displayOptions[a]),null!==t&&(r[displayOptions[a]]=t);for(var n in r)r.hasOwnProperty(n)&&i.push(encodeURIComponent(n)+"="+encodeURIComponent(r[n]));return"&"+i.join("&")},document.onreadystatechange=function(){"complete"===document.readyState&&i()},"complete"===document.readyState&&i()}(window.FlickrEmbedr.baseURL);