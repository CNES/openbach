"use strict";(self.webpackChunkihm=self.webpackChunkihm||[]).push([[220],{1220:function(e,n,t){t.r(n),t.d(n,{default:function(){return $e}});var r=t(1413),i=t(9439),a=t(2791),o=t(7689),s=t(4395),c=t(3896),l=t(5228),u=t(3433),d=t(4554),f=t(6151),h=t(9157),p=t(1691),j=t(5699),x=t(7381),v=t(565),m=t(1524),g=t(9877),b=t(5130),Z=t(8096),y=t(4925),k=t(3786),C=t(9321),w=t(7391),S=t(7621),A=t(2363),N=t(9504),I=t(4942),M=t(3366),P=t(7462),T=t(8182),E=t(4419),R=t(890),O=t(3736),D=t(7630),F=t(5878),W=t(1217);function H(e){return(0,W.Z)("MuiCardHeader",e)}var z=(0,F.Z)("MuiCardHeader",["root","avatar","action","content","title","subheader"]),_=t(184),U=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],q=(0,D.ZP)("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:function(e,n){var t;return(0,P.Z)((t={},(0,I.Z)(t,"& .".concat(z.title),n.title),(0,I.Z)(t,"& .".concat(z.subheader),n.subheader),t),n.root)}})({display:"flex",alignItems:"center",padding:16}),L=(0,D.ZP)("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:function(e,n){return n.avatar}})({display:"flex",flex:"0 0 auto",marginRight:16}),B=(0,D.ZP)("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:function(e,n){return n.action}})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),J=(0,D.ZP)("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:function(e,n){return n.content}})({flex:"1 1 auto"}),V=a.forwardRef((function(e,n){var t=(0,O.Z)({props:e,name:"MuiCardHeader"}),r=t.action,i=t.avatar,a=t.className,o=t.component,s=void 0===o?"div":o,c=t.disableTypography,l=void 0!==c&&c,u=t.subheader,d=t.subheaderTypographyProps,f=t.title,h=t.titleTypographyProps,p=(0,M.Z)(t,U),j=(0,P.Z)({},t,{component:s,disableTypography:l}),x=function(e){var n=e.classes;return(0,E.Z)({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},H,n)}(j),v=f;null==v||v.type===R.Z||l||(v=(0,_.jsx)(R.Z,(0,P.Z)({variant:i?"body2":"h5",className:x.title,component:"span",display:"block"},h,{children:v})));var m=u;return null==m||m.type===R.Z||l||(m=(0,_.jsx)(R.Z,(0,P.Z)({variant:i?"body2":"body1",className:x.subheader,color:"text.secondary",component:"span",display:"block"},d,{children:m}))),(0,_.jsxs)(q,(0,P.Z)({className:(0,T.Z)(x.root,a),as:s,ref:n,ownerState:j},p,{children:[i&&(0,_.jsx)(L,{className:x.avatar,ownerState:j,children:i}),(0,_.jsxs)(J,{className:x.content,ownerState:j,children:[v,m]}),r&&(0,_.jsx)(B,{className:x.action,ownerState:j,children:r})]}))}));function G(e){return(0,W.Z)("MuiCardMedia",e)}(0,F.Z)("MuiCardMedia",["root","media","img"]);var K=["children","className","component","image","src","style"],Q=(0,D.ZP)("div",{name:"MuiCardMedia",slot:"Root",overridesResolver:function(e,n){var t=e.ownerState,r=t.isMediaComponent,i=t.isImageComponent;return[n.root,r&&n.media,i&&n.img]}})((function(e){var n=e.ownerState;return(0,P.Z)({display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},n.isMediaComponent&&{width:"100%"},n.isImageComponent&&{objectFit:"cover"})})),Y=["video","audio","picture","iframe","img"],X=["picture","img"],$=a.forwardRef((function(e,n){var t=(0,O.Z)({props:e,name:"MuiCardMedia"}),r=t.children,i=t.className,a=t.component,o=void 0===a?"div":a,s=t.image,c=t.src,l=t.style,u=(0,M.Z)(t,K),d=-1!==Y.indexOf(o),f=!d&&s?(0,P.Z)({backgroundImage:'url("'.concat(s,'")')},l):l,h=(0,P.Z)({},t,{component:o,isMediaComponent:d,isImageComponent:-1!==X.indexOf(o)}),p=function(e){var n=e.classes,t={root:["root",e.isMediaComponent&&"media",e.isImageComponent&&"img"]};return(0,E.Z)(t,G,n)}(h);return(0,_.jsx)(Q,(0,P.Z)({className:(0,T.Z)(p.root,i),as:o,role:!d&&s?"img":void 0,ref:n,style:f,ownerState:h,src:d?s||c:void 0},u,{children:r}))})),ee=t(5346),ne=function(e){var n=e.title,t=e.subtitle,r=e.media,i=e.actions,a=e.children,o=(0,ee.v9)((function(e){return e.login.is_user}));return(0,_.jsxs)(S.Z,{sx:{position:"relative"},children:[(0,_.jsx)(V,{title:n,subheader:t,sx:{height:"64px",backgroundColor:"rgba(0, 0, 0, 0.4)"}}),(0,_.jsx)($,{component:"img",alt:"header logo",image:r,height:"96",sx:{objectFit:"contain",position:"absolute",width:"96px",top:0,right:8}}),(0,_.jsx)(N.Z,{children:a}),o&&null!=i&&(0,_.jsx)(A.Z,{disableSpacing:!0,sx:{display:"flex",flexDirection:"column",gap:1},children:i})]})},te=t(2542),re="/assets/project.svg",ie=function(e){var n=e.project,t=(0,ee.v9)((function(e){return e.login.is_user})),r=(0,ee.v9)((function(e){return e.openbach.agents})),o=(0,ee.I0)(),s=a.useState(""),c=(0,i.Z)(s,2),l=c[0],u=c[1],d=a.useState(""),h=(0,i.Z)(d,2),p=h[0],j=h[1],x=a.useState(""),v=(0,i.Z)(x,2),m=v[0],g=v[1],b=a.useCallback((function(e){u(e.target.value)}),[]),S=a.useCallback((function(e){j(e.target.value)}),[]),A=a.useCallback((function(e){var n=e.target.value;g(n||"")}),[]),N=a.useCallback((function(){l&&(o((0,te.Ce)({project:n,name:l,description:p||void 0,agent:null===r||void 0===r?void 0:r.find((function(e){return e.address===m}))})),u(""),j(""),g(""))}),[n,r,l,p,m,o]),I=a.useMemo((function(){return(r||[]).filter((function(e){return!e.project&&e.reserved===n})).map((function(e){return(0,_.jsx)(k.Z,{value:e.address,children:e.name},e.address)}))}),[r,n]),M=a.useMemo((function(){return(r||[]).filter((function(e){return!e.project&&!e.reserved})).map((function(e){return(0,_.jsx)(k.Z,{value:e.address,children:e.name},e.address)}))}),[r]);return t?(0,_.jsxs)(ne,{title:"Add Entity",subtitle:"Create a new Entity for an Agent",media:re,actions:(0,_.jsx)(f.Z,{variant:"contained",color:"secondary",disabled:!l,onClick:N,children:"Add Entity"}),children:[(0,_.jsx)(w.Z,{required:!0,margin:"dense",variant:"standard",label:"Entity Name",value:l,onChange:b,fullWidth:!0}),(0,_.jsx)(w.Z,{margin:"dense",variant:"standard",label:"Entity Description",value:p,onChange:S,fullWidth:!0,multiline:!0,rows:3}),(0,_.jsxs)(Z.Z,{fullWidth:!0,sx:{mt:3},children:[(0,_.jsx)(y.Z,{id:"entity-add-label",children:"Associated Agent"}),(0,_.jsxs)(C.Z,{required:!0,labelId:"entity-add-label",id:"entity-add-select",label:"Associated Agent",value:m,onChange:A,children:[(0,_.jsx)(k.Z,{value:""}),(0,_.jsx)(k.Z,{children:"--- Agents reserved for this project ---"}),I,(0,_.jsx)(k.Z,{children:"--- Free Agents ---"}),M]})]})]}):(0,_.jsx)(ne,{title:"Entity",subtitle:"Click on an entity to select it",media:re,children:"No entity selected"})},ae=function(e){var n=e.project,t=e.jobs,r=e.agent,i=e.onAgentChange,o=(0,ee.v9)((function(e){return e.openbach.agents})),s=a.useCallback((function(e){var n=e.target.value;i(n?null===o||void 0===o?void 0:o.find((function(e){return e.address===n})):void 0)}),[o,i]),c=a.useMemo((function(){return(o||[]).filter((function(e){return e.reserved===n&&(!e.project||e.address===(null===r||void 0===r?void 0:r.address))})).map((function(e){return(0,_.jsx)(k.Z,{value:e.address,children:e.name},e.address)}))}),[o,n,r]),l=a.useMemo((function(){return(o||[]).filter((function(e){return!e.reserved&&(!e.project||e.address===(null===r||void 0===r?void 0:r.address))})).map((function(e){return(0,_.jsx)(k.Z,{value:e.address,children:e.name},e.address)}))}),[o,r]),u=(0,_.jsxs)(Z.Z,{fullWidth:!0,children:[(0,_.jsx)(y.Z,{id:"entity-change-label",children:"Associated Agent"}),(0,_.jsxs)(C.Z,{labelId:"entity-change-label",id:"entity-change-select",label:"Associated Agent",value:(null===r||void 0===r?void 0:r.address)||"",onChange:s,children:[(0,_.jsx)(k.Z,{value:""}),(0,_.jsx)(k.Z,{children:"--- Agents reserved for this project ---"}),c,(0,_.jsx)(k.Z,{children:"--- Free Agents ---"}),l]})]});if(!r)return u;var d=null===o||void 0===o?void 0:o.find((function(e){return e.address===r.address})),f=null===d||void 0===d?void 0:d.services,h=null!==f&&void 0!==f&&f.hasOwnProperty("ntp.service")?f["ntp.service"].split(/\r?\n/).find((function(e){return e.startsWith("*")})):"",p=""===h?"NTP status not fetched":h?"NTP offset: "+h.split(/\s+/)[8]+" ms":"NTP not synchronized",j=null===d||void 0===d?void 0:d.errors;return(0,_.jsxs)("ul",{children:[(0,_.jsx)("li",{children:u}),(0,_.jsxs)("li",{children:["IP used for installation: ",(0,_.jsx)("b",{children:r.address})]}),(0,_.jsxs)("li",{children:["Collector: ",(0,_.jsx)("b",{children:r.collector_ip})]}),(0,_.jsxs)("li",{children:["Installed jobs: ",t.length?(0,_.jsx)("ul",{children:t.map((function(e){return(0,_.jsx)("li",{children:e},e)}))}):"No jobs installed"]}),(0,_.jsx)("li",{children:p}),j&&j.length>0&&(0,_.jsx)("li",{children:(0,_.jsx)("ul",{children:j.map((function(e,n){return(0,_.jsx)("li",{children:e.msg},n)}))})})]})},oe=t(1918),se=t(178),ce=t(248),le=function(e){var n=e.options,t=e.action,r=e.agent,o=(0,ee.I0)(),s=a.useState([]),c=(0,i.Z)(s,2),l=c[0],u=c[1],h=a.useCallback((function(e){var n=e.target.value;u("string"===typeof n?[]:n)}),[]),p=a.useCallback((function(){if(l.length){switch(t){case"install":o((0,se.eJ)({jobNames:l,agents:[r]}));break;case"uninstall":o((0,se.xT)({jobNames:l,agents:[r]}));break;default:return void u([])}l.forEach((function(e){o((0,ce.q2)({job:e,agent:r,action:t}))})),setTimeout((function(){window.scrollTo({top:document.body.scrollHeight,left:0,behavior:"smooth"})}),50)}u([])}),[l,t,r,o]);return a.useEffect((function(){u([])}),[n]),(0,_.jsxs)(d.Z,{display:"flex",alignItems:"center",width:"100%",gap:1,children:[(0,_.jsxs)(f.Z,{variant:"contained",color:"secondary",onClick:p,children:[t," jobs"]}),(0,_.jsx)(Z.Z,{sx:{flexGrow:1},children:(0,_.jsx)(C.Z,{multiple:!0,fullWidth:!0,value:l,onChange:h,renderValue:function(e){return(0,_.jsx)(d.Z,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map((function(e){return(0,_.jsx)(oe.Z,{label:e},e)}))})},children:n.map((function(e){return(0,_.jsx)(k.Z,{value:e,children:e},e)}))})})]})},ue=t(2050),de=function(e){var n=e.project,t=e.entity,r=t.name,o=t.description,s=t.agent,c=t.networks,l=e.onRemove,u=(0,ee.v9)((function(e){return e.openbach.jobs})),d=(0,ee.I0)(),h=a.useState([]),p=(0,i.Z)(h,2),j=p[0],x=p[1],v=a.useCallback((function(){d((0,te.Sx)({project:n,name:r})),l()}),[n,r,d,l]),m=a.useCallback((function(e){d((0,te.BU)({project:n,name:r,description:o,agent:e,networks:c}))}),[n,r,o,c,d]),g=a.useMemo((function(){return(c||[]).map((function(e){return(0,_.jsxs)("li",{children:[e.interface,": ",e.ip," (network ",e.name,")"]},e.interface)}))}),[c]);a.useEffect((function(){if(s){var e=s.address,n=d((0,ue.Ly)({address:e}));return n.unwrap().then((function(e){x(e)})),function(){n.abort()}}}),[s,d]);var b=(0,_.jsx)(f.Z,{variant:"contained",color:"secondary",onClick:v,children:"Remove Entity"});return(0,_.jsx)(ne,{title:"Entity",subtitle:"Click on an entity to select it",media:"/assets/server.svg",actions:s?(0,_.jsxs)(a.Fragment,{children:[(0,_.jsx)(le,{agent:s.address,action:"install",options:(u||[]).filter((function(e){return!j.includes(e.general.name)})).map((function(e){return e.general.name}))}),(0,_.jsx)(le,{agent:s.address,action:"uninstall",options:j}),b]}):b,children:(0,_.jsxs)("ul",{children:[(0,_.jsxs)("li",{children:["Description: ",(0,_.jsx)("b",{children:o})]}),(0,_.jsxs)("li",{children:["OS: ",(0,_.jsx)("b",{children:"Linux"})]}),(0,_.jsxs)("li",{children:["Interfaces: ",(0,_.jsx)("ul",{children:g})]}),(0,_.jsxs)("li",{children:["Agent:",(0,_.jsx)(ae,{jobs:j,agent:s,project:n,onAgentChange:m})]})]})})},fe=t(5522),he=t(5616),pe=function(e){var n=e.network,t=n.name,o=n.address,s=e.onChange,c=(0,ee.v9)((function(e){return e.project.current})),l=(0,ee.I0)(),d=a.useState(t),h=(0,i.Z)(d,2),p=h[0],j=h[1],x=a.useCallback((function(e){j(e.target.value)}),[]),v=a.useCallback((function(){c&&l((0,fe.f3)({project:c.name,newName:{name:p,address:o}}))}),[c,o,p,l]),m=a.useCallback((function(){if(c){l((0,he.PJ)("Updating Topology, please wait!"));var e=[].concat((0,u.Z)(c.hidden_network),[o]);l((0,fe.ty)({name:c.name,project:(0,r.Z)((0,r.Z)({},c),{},{hidden_network:e})})),s()}}),[c,o,l,s]);return(0,_.jsxs)(ne,{title:t,subtitle:o,media:"/assets/cloud.svg",actions:(0,_.jsxs)(a.Fragment,{children:[(0,_.jsx)(f.Z,{variant:"contained",color:"secondary",disabled:!t||t===p,onClick:v,children:"Change Name"}),(0,_.jsx)(f.Z,{variant:"contained",color:"secondary",onClick:m,children:"Hide Network"})]}),children:[(0,_.jsxs)("p",{children:["Network ",o]}),(0,_.jsx)(w.Z,{required:!0,margin:"dense",variant:"standard",label:"Name",value:p,onChange:x,fullWidth:!0})]})},je=function(e){var n=e.project,t=e.selectedEntity,r=e.selectedNetwork,i=e.onUnselect,a=t?(0,_.jsx)(de,{entity:t,project:n,onRemove:i}):r?(0,_.jsx)(pe,{network:r,onChange:i}):(0,_.jsx)(ie,{project:n});return(0,_.jsxs)(d.Z,{display:"inline-block",width:"30%",position:"relative",children:[(null!=t||null!=r)&&(0,_.jsx)(g.Z,{color:"primary",size:"medium",onClick:i,sx:{position:"absolute",top:"-16px",right:"-16px"},children:(0,_.jsx)(b.Z,{})}),a]})},xe=t(493),ve=t(6278),me=t(7064),ge=t(9900),be=t(5519),Ze=t(2460),ye=t(7),ke=t(6633),Ce=t(22),we=t(8384),Se=t(5857),Ae=function(e){if(!e.status)return(0,_.jsx)(Se.Z,{sx:{color:be.Z[500]}});var n=e.status.returncode;return n?202===n?(0,_.jsx)(ke.Z,{sx:{color:"#2A72A9"}}):n<400?(0,_.jsx)(we.Z,{sx:{color:ye.Z[500]}}):(0,_.jsx)(Ce.Z,{sx:{color:Ze.Z[500]}}):(0,_.jsx)(Se.Z,{sx:{color:Ze.Z[500]}})},Ne=function(e){var n=e.job,t=e.agent,r=e.action,i=e.status,o=e.onClick,s=(0,ee.I0)(),c=a.useMemo((function(){return"".concat(r,"ing ").concat(n," on ").concat(t)}),[r,n,t]),l=a.useCallback((function(){s((0,se.Kn)({jobName:n,agent:t}))}),[n,t,s]),u=a.useCallback((function(){var e=i?i.response?i.response.state?"Operation "+i.response.state:i.response.response?JSON.stringify(i.response.response):"Format of the response is unknown. Return code was "+i.response.returncode:"Operation successful!":"Operation not started yet!";o(c,e)}),[c,i,o]);return a.useEffect((function(){if(!i||202===i.returncode){var e=setTimeout(l,1e3);return function(){clearTimeout(e)}}if(i&&202!==i.returncode){var n=s((0,ue.j8)({services:!1}));return function(){n.abort()}}}),[i,l,s]),(0,_.jsxs)(ve.Z,{onClick:u,children:[(0,_.jsx)(me.Z,{children:(0,_.jsx)(Ae,{status:i})}),(0,_.jsx)(ge.Z,{primary:c})]})},Ie=function(e){var n=(0,ee.v9)((function(e){return e.project.jobActions})),t=a.useState(""),r=(0,i.Z)(t,2),o=r[0],s=r[1],c=a.useState(""),l=(0,i.Z)(c,2),u=l[0],d=l[1],f=a.useCallback((function(e,n){s(e),d(n)}),[]),x=a.useCallback((function(){s(""),d("")}),[]);return(0,_.jsxs)(a.Fragment,{children:[(0,_.jsx)(xe.Z,{children:n.map((function(e){return(0,_.jsx)(Ne,{job:e.job,agent:e.agent,action:e.action,status:e.result&&e.result[e.action],onClick:f},"".concat(e.job,"-on-").concat(e.agent))}))}),(0,_.jsx)(j.Z,{title:o,open:!(!o&&!u),cancel:{label:"OK",action:x},actions:[],children:(0,_.jsx)(h.Z,{children:(0,_.jsx)(p.Z,{children:u})})})]})},Me=function(e){var n=e.title,t=e.label,r=e.initial,o=e.options,s=e.canDoAction,c=e.onAction,l=a.useState([]),u=(0,i.Z)(l,2),h=u[0],p=u[1],j=a.useCallback((function(e){var n=e.target.value;p("string"===typeof n?[]:n)}),[]),x=a.useCallback((function(){c(h)}),[h,c]);return a.useEffect((function(){p(r)}),[r]),(0,_.jsxs)(d.Z,{display:"flex",alignItems:"center",children:[(0,_.jsx)("p",{children:n}),(0,_.jsx)(Z.Z,{size:"small",sx:{flexGrow:1,margin:"0 5px"},children:(0,_.jsx)(C.Z,{multiple:!0,fullWidth:!0,value:h,onChange:j,renderValue:function(e){return(0,_.jsx)(d.Z,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map((function(e){return(0,_.jsx)(oe.Z,{label:e},e)}))})},children:o.map((function(e){return(0,_.jsx)(k.Z,{value:e,children:e},e)}))})}),(0,_.jsx)(f.Z,{variant:"contained",color:"secondary",disabled:!s,onClick:x,children:t})]})},Pe={margin:"0 15px 10px"},Te=function(e){var n,t=(0,ee.v9)((function(e){return e.project.current})),s=(0,ee.v9)((function(e){return e.login.is_admin})),c=(0,ee.v9)((function(e){return e.login.is_user})),l=(0,ee.I0)(),g=(0,o.s0)(),b=a.useState(!1),Z=(0,i.Z)(b,2),y=Z[0],k=Z[1],C=a.useState(),w=(0,i.Z)(C,2),S=w[0],A=w[1],N=a.useState(),I=(0,i.Z)(N,2),M=I[0],P=I[1],T=a.useCallback((function(){k(!0)}),[]),E=a.useCallback((function(){k(!1)}),[]),R=a.useCallback((function(){A(void 0),P(void 0)}),[]),O=a.useCallback((function(e){t&&("network"===e.type?(A(void 0),P(t.network.find((function(n){return n.address===e.id})))):"entity"===e.type?(A(t.entity.find((function(n){return n.name===e.id}))),P(void 0)):(A(void 0),P(void 0)))}),[t]),D=a.useCallback((function(){l((0,he.PJ)("Fetching Agents statusses. Please wait...")),l((0,ue.j8)({services:!0}))}),[l]),F=a.useCallback((function(e){t&&l((0,fe.ty)({name:t.name,project:(0,r.Z)((0,r.Z)({},t),{},{owners:e})}))}),[t,l]),W=a.useCallback((function(e){if(t){var n=t.hidden_network.filter((function(n){return!e.includes(n)}));l((0,he.PJ)("Updating Topology, please wait!")),l((0,fe.ty)({name:t.name,project:(0,r.Z)((0,r.Z)({},t),{},{hidden_network:n})}))}}),[t,l]),H=a.useCallback((function(){t&&l((0,fe.f3)({project:t.name}))}),[t,l]),z=a.useCallback((function(e){if(t){var n=JSON.parse(e);l((0,fe.ty)({name:t.name,project:n}))}}),[t,l]),U=a.useCallback((function(){t&&l((0,fe.th)({name:t.name})).unwrap().then((function(){return g("/app")})),E()}),[t,E,l,g]),q=a.useMemo((function(){var e=[];if(!t)return[e,[]];var n=t.network.map((function(e){return{name:e.name,id:e.address,type:"network",color:e.address.startsWith("imported:")?"tomato":void 0}})),r=t.entity.map((function(t){var r,i={name:t.name,id:t.name,type:"entity",color:t.agent?"green":"black"};return null===(r=t.networks)||void 0===r||r.forEach((function(t){var r=n.find((function(e){return e.id===t.address}));r&&e.push({source:i,target:r,weight:3})})),i}));return[e,r.concat(n)]}),[t]),L=(0,i.Z)(q,2),B=L[0],J=L[1];if(!t)return null;var V=s||!(null!==(n=t.owners)&&void 0!==n&&n.length)&&c,G=(0,u.Z)(t.owners);return(0,_.jsxs)(a.Fragment,{children:[(0,_.jsxs)("h1",{children:["Project '",t.name,"'"]}),(0,_.jsx)(d.Z,{mb:"8px",pb:"8px",children:t.description.split("\n").map((function(e,n){return(0,_.jsx)("p",{children:e},n)}))}),(0,_.jsx)(Me,{title:"Project Owners",label:"Share",initial:t.owners,options:G,canDoAction:V,onAction:F}),(0,_.jsx)(Me,{title:"Hidden Networks",label:"Show",initial:t.hidden_network,options:t.hidden_network,canDoAction:c,onAction:W}),(0,_.jsxs)(d.Z,{display:"flex",alignItems:"center",justifyContent:"center",children:[(0,_.jsx)(f.Z,{variant:"contained",color:"secondary",disabled:!c,onClick:H,sx:Pe,children:"Refresh Topology"}),(0,_.jsx)(f.Z,{variant:"contained",color:"secondary",disabled:!c,onClick:D,sx:Pe,children:"Fetch NTP Offset"}),(0,_.jsx)(x.Z,{route:"/openbach/project/".concat(t.name),filename:"".concat(t.name,".json"),label:"Project",sx:Pe}),(0,_.jsx)(v.Z,{label:"Project",initial:t,onUpdate:z,disabled:!c,sx:Pe}),(0,_.jsx)(f.Z,{variant:"contained",color:"secondary",disabled:!V,onClick:T,sx:Pe,children:"Delete Project"})]}),(0,_.jsx)("h1",{children:"Topology"}),(0,_.jsxs)(d.Z,{display:"flex",alignItems:"flex-start",children:[(0,_.jsx)(d.Z,{display:"inline-block",width:"70%",children:(0,_.jsx)(m.Z,{height:"800px",nodes:J,links:B,selectedNode:O,unselectNode:R})}),(0,_.jsx)(je,{entities:t.entity,project:t.name,selectedEntity:S,selectedNetwork:M,onUnselect:R})]}),(0,_.jsx)(Ie,{}),(0,_.jsx)(j.Z,{title:"Are you sure?",open:y,cancel:{label:"Cancel",action:E},actions:[{label:"Delete",action:U}],children:(0,_.jsx)(h.Z,{children:(0,_.jsxs)(p.Z,{children:["Deleting the project ",t.name," is irreversible. Proceed anyways?"]})})})]})},Ee=t(4721),Re=t(1134),Oe=t(4950),De=function(e){var n=(0,o.UO)().projectId,t=(0,ee.I0)(),r=(0,o.s0)(),i=(0,Re.cI)({mode:"onBlur"}),s=i.control,c=i.handleSubmit,l=i.reset,u=i.formState.isValid,d=a.useCallback((function(e){var i=e.scenario;n&&(t((0,Oe.dw)({project:n,scenario:i})).unwrap().then((function(){r("/app/project/".concat(n,"/scenario/").concat(i))})),l())}),[n,t,r,l]);return(0,_.jsx)(S.Z,{sx:{flexGrow:1},children:(0,_.jsxs)("form",{onSubmit:c(d),children:[(0,_.jsxs)(N.Z,{children:[(0,_.jsx)("h1",{children:"Create Scenario"}),(0,_.jsx)(Re.Qr,{name:"scenario",control:s,rules:{required:!0},defaultValue:"",render:function(e){var n=e.field,t=n.onChange,r=n.onBlur,i=n.value,a=n.ref;return(0,_.jsx)(w.Z,{required:!0,margin:"dense",variant:"standard",label:"Scenario Name",onChange:t,onBlur:r,value:i,inputRef:a,fullWidth:!0})}})]}),(0,_.jsx)(A.Z,{children:(0,_.jsx)(f.Z,{color:"secondary",variant:"contained",type:"submit",disabled:!u,children:"New Scenario"})})]})})},Fe=t(818),We=function(e){var n=(0,o.UO)().projectId,t=(0,ee.I0)(),r=(0,o.s0)(),i=(0,Re.cI)({mode:"onBlur"}),s=i.handleSubmit,c=i.register,l=i.reset,u=i.formState.isValid,d=a.useCallback((function(e){var i=e.scenario;n&&(t((0,Oe.by)({project:n,scenario:i[0]})).unwrap().then((function(e){var t=e.name;r("/app/project/".concat(n,"/scenario/").concat(t))})),l())}),[n,t,l,r]);return(0,_.jsx)(S.Z,{sx:{flexGrow:1},children:(0,_.jsxs)("form",{onSubmit:s(d),children:[(0,_.jsxs)(N.Z,{children:[(0,_.jsx)("h1",{children:"Import Scenario"}),(0,_.jsx)(Fe.Z,{label:"Scenario's File",accept:".json",required:!0,name:"scenario",register:c,options:{required:!0}})]}),(0,_.jsx)(A.Z,{children:(0,_.jsx)(f.Z,{color:"secondary",variant:"contained",type:"submit",disabled:!u,children:"Import Scenario"})})]})})},He=t(1087),ze=t(3400),_e=t(6112),Ue=t(349),qe=t(6520),Le={50:"#f1f8e9",100:"#dcedc8",200:"#c5e1a5",300:"#aed581",400:"#9ccc65",500:"#8bc34a",600:"#7cb342",700:"#689f38",800:"#558b2f",900:"#33691e",A100:"#ccff90",A200:"#b2ff59",A400:"#76ff03",A700:"#64dd17"},Be=t(9513),Je=function(e){var n=e.title,t=void 0===n?"Launch":n;return(0,_.jsx)(qe.Z,{title:t,placement:"top-start",children:(0,_.jsx)(Be.Z,{sx:{color:Le[500]}})})},Ve=function(e){var n=e.scenario,t=n.name,r=n.openbach_functions,i=n.arguments,o=e.onDelete,s=e.onLaunch,c=(0,ee.v9)((function(e){return e.project.current})),l=a.useCallback((function(e){e.preventDefault(),e.stopPropagation(),s({scenario:t,args:Object.keys(i)})}),[t,i,s]),u=a.useCallback((function(e){e.preventDefault(),e.stopPropagation(),o(t)}),[o,t]),d=r.length,f="".concat(d," openbach function").concat(d>1?"s":"");return(0,_.jsxs)(ve.Z,{component:He.rU,to:"/app/project/".concat(null===c||void 0===c?void 0:c.name,"/scenario/").concat(t),disableRipple:!0,children:[(0,_.jsx)(me.Z,{onClick:l,children:(0,_.jsx)(Je,{})}),(0,_.jsx)(ge.Z,{primary:t,secondary:f}),(0,_.jsx)(_e.Z,{children:(0,_.jsx)(ze.Z,{edge:"end",onClick:u,children:(0,_.jsx)(Ue.Z,{})})})]})},Ge=t(808),Ke=function(e){var n=(0,o.UO)().scenarioId,t=(0,ee.v9)((function(e){return e.project.current})),r=(0,ee.v9)((function(e){return e.login.favorites})),s=(0,ee.I0)(),c=(0,o.s0)(),l=a.useState(),u=(0,i.Z)(l,2),f=u[0],x=u[1],v=a.useState(),m=(0,i.Z)(v,2),g=m[0],b=m[1],Z=a.useCallback((function(e){b(e)}),[]),y=a.useCallback((function(){b(void 0)}),[]),k=a.useCallback((function(e){x(e)}),[]),C=a.useCallback((function(){x(void 0)}),[]),w=a.useCallback((function(){null!==t&&void 0!==t&&t.name&&f&&s((0,Oe.gh)({project:t.name,scenario:f})).unwrap().then((function(){f===n&&c("/app/project/"+t.name)})),C()}),[t,f,n,C,s,c]),S=a.useMemo((function(){var e=null===t||void 0===t?void 0:t.name;return e&&r.hasOwnProperty(e)?Object.fromEntries(r[e].map((function(e){return[e,!0]}))):{}}),[r,t]),A=a.useMemo((function(){var e;return((null===t||void 0===t||null===(e=t.scenario)||void 0===e?void 0:e.slice())||[]).sort((function(e,n){return e.name.localeCompare(n.name)}))}),[t]),N=A.filter((function(e){return S[e.name]})).map((function(e){return(0,_.jsx)(Ve,{scenario:e,onLaunch:Z,onDelete:k},e.name)})),I=A.filter((function(e){return!S[e.name]})).map((function(e){return(0,_.jsx)(Ve,{scenario:e,onLaunch:Z,onDelete:k},e.name)})),M=N.length>0&&0<I.length;return(0,_.jsxs)(a.Fragment,{children:[(0,_.jsx)(xe.Z,{children:N}),M&&(0,_.jsx)(Ee.Z,{}),(0,_.jsx)(xe.Z,{children:I}),(0,_.jsxs)(d.Z,{display:"flex",alignItems:"flex-start",gap:"10%",pl:"10%",pr:"10%",pt:5,width:"100%",boxSizing:"border-box",children:[(0,_.jsx)(De,{}),(0,_.jsx)(We,{})]}),(0,_.jsx)(j.Z,{title:"Really Delete this Scenario?",open:Boolean(f),cancel:{label:"Cancel",action:C},actions:[{label:"Delete",action:w}],children:(0,_.jsx)(h.Z,{children:(0,_.jsxs)(p.Z,{children:['The scenario "',f,'" will be deleted. This action is unrecoverable. Do you want to continue?']})})}),t&&g&&(0,_.jsx)(Ge.Z,{project:t.name,scenario:g.scenario,arguments:g.args,onClose:y})]})},Qe=t(4835),Ye=t(2415),Xe=function(e){var n=e.value,t=e.selected,r=e.children,i=n!==t;return(0,_.jsx)("div",{role:"tabpanel",hidden:i,children:!i&&r})},$e=function(e){var n=(0,o.UO)(),t=n.projectId,u=n.scenarioId,d=(0,ee.I0)(),f=a.useState("project"),h=(0,i.Z)(f,2),p=h[0],j=h[1],x=a.useCallback((function(e,n){j(n)}),[]);return a.useEffect((function(){if(d((0,he.Td)("Project '".concat(t,"'"))),t){var e=d((0,fe.e5)({name:t}));return function(){e.abort()}}}),[d,t]),a.useEffect((function(){d((0,ce._R)()),u&&j("selected")}),[u,d]),a.useEffect((function(){var e=[d((0,ue.j8)({services:!1})),d((0,se.Ly)())];return function(){e.forEach((function(e){e.abort()}))}}),[d]),(0,_.jsxs)(a.Fragment,{children:[(0,_.jsx)(s.Z,{color:"primary",sx:(0,r.Z)({position:"static"},Ye.r),children:(0,_.jsxs)(l.Z,{value:p,onChange:x,centered:!0,variant:"fullWidth",textColor:"inherit",indicatorColor:"secondary",children:[(0,_.jsx)(c.Z,{label:"Project",value:"project"}),(0,_.jsx)(c.Z,{label:"Scenarios",value:"scenarios"}),(0,_.jsx)(c.Z,{label:"Instances",value:"instances"}),(0,_.jsx)(c.Z,{label:u||"No Scenario Selected",value:"selected",disabled:!u})]})}),(0,_.jsx)(Xe,{value:"project",selected:p,children:(0,_.jsx)(Te,{})}),(0,_.jsx)(Xe,{value:"scenarios",selected:p,children:(0,_.jsx)(Ke,{})}),(0,_.jsx)(Xe,{value:"instances",selected:p,children:t&&(0,_.jsx)(Qe.Z,{project:t})}),(0,_.jsx)(Xe,{value:"selected",selected:p,children:e.children})]})}},1524:function(e,n,t){var r=t(9439),i=t(2791),a=t(5002),o=t(184),s={entity:"/assets/server.svg",network:"/assets/cloud.svg",project:"/assets/project.svg"};n.Z=function(e){var n=e.height,t=e.nodes,c=e.links,l=e.selectedNode,u=e.unselectNode,d=function(){var e=i.useState({width:void 0,height:void 0}),n=(0,r.Z)(e,2),t=n[0],a=n[1];return i.useEffect((function(){var e=function(){a({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),t}(),f=i.useRef(null);return i.useEffect((function(){if(f.current){for(;f.current.children.length>0;)f.current.children[0].remove();var e=f.current.clientHeight,n=f.current.clientWidth,r=a.A4v(t).force("link",a.Fsl(c).id((function(e){return e.id})).strength((function(e){return e.weight}))).force("collide",a.Hh(30)).force("center-x",a.RUJ(0)).force("center-y",a.Mrm(0)).on("tick",(function(){d.attr("x1",(function(e){return e.source.x})).attr("y1",(function(e){return e.source.y})).attr("x2",(function(e){return e.target.x})).attr("y2",(function(e){return e.target.y})),h.attr("transform",(function(e){return"translate(".concat(e.x,", ").concat(e.y,")")}))})),i=a.Ys(f.current).attr("viewBox",[-n/2,-e/2,n,e]).attr("style","max-width: 100%; height: auto; height: intrinsic;"),o=i.append("rect").attr("fill","white").attr("height",e).attr("width",n).attr("x",-n/2).attr("y",-e/2),d=i.append("g").attr("class","links").selectAll(".link").data(c).enter().append("line").attr("stroke","#AAA").attr("stroke-width",(function(e){return Math.sqrt(e.weight)})),h=i.append("g").attr("class","nodes").selectAll(".node").data(t).enter().append("g").on("dblclick",(function(e,n){n.fx=null,n.fy=null})).call(a.ohM().on("start",(function(e){e.active||r.alphaTarget(.3).restart(),e.subject.fx=e.subject.x,e.subject.fy=e.subject.y})).on("drag",(function(e){e.subject.fx=e.x,e.subject.fy=e.y})).on("end",(function(e){e.active||r.alphaTarget(0)})));return h.append("svg:image").attr("height",30).attr("width",30).attr("x",-15).attr("y",-15).attr("xlink:href",(function(e){return s[e.type]})),h.append("text").text((function(e){return e.name})).attr("cursor","pointer").attr("dx",12).attr("dy",".35em").style("fill",(function(e){return e.color?e.color:"network"===e.type?"#757575":"black"})),l&&h.on("click",(function(e,n){return l(n)})),u&&o.on("click",u),function(){r.stop()}}}),[t,c,l,u,d]),(0,o.jsx)("svg",{ref:f,height:n,width:"100%"})}},5130:function(e,n,t){var r=t(4836);n.Z=void 0;var i=r(t(5649)),a=t(184),o=(0,i.default)((0,a.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");n.Z=o},22:function(e,n,t){var r=t(4836);n.Z=void 0;var i=r(t(5649)),a=t(184),o=(0,i.default)((0,a.jsx)("path",{d:"M14.59 8 12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41 14.59 8zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"HighlightOff");n.Z=o},9513:function(e,n,t){var r=t(4836);n.Z=void 0;var i=r(t(5649)),a=t(184),o=(0,i.default)((0,a.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 14.5v-9l6 4.5-6 4.5z"}),"PlayCircleFilled");n.Z=o}}]);
//# sourceMappingURL=220.5aecb5e9.chunk.js.map